{% extends 'dashboard/base.html' %}

{% block content %}
<h2>Products</h2>

<!-- Filter Form -->
<form method="GET" class="row g-3 mb-4">
    <div class="col-md-3">
        <select name="category" class="form-select">
            <option value="">All Categories</option>
            {% for cat in categories %}
            <option value="{{ cat.id }}" {% if selected_category == cat.id|stringformat:"s" %}selected{% endif %}>
                {{ cat.name }}
            </option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-3">
        <select name="subcategory" class="form-select">
            <option value="">All Subcategories</option>
            {% for sub in subcategories %}
            <option value="{{ sub.id }}" {% if selected_subcategory == sub.id|stringformat:"s" %}selected{% endif %}>
                {{ sub.name }}
            </option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-2">
        <input type="number" name="min_price" class="form-control" placeholder="Min Price" value="{{ min_price }}">
    </div>
    <div class="col-md-2">
        <input type="number" name="max_price" class="form-control" placeholder="Max Price" value="{{ max_price }}">
    </div>
    <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100">Filter</button>
    </div>
</form>

<!-- Products Table -->
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Name</th>
            <th>Category</th>
            <th>SubCategory</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for product in products %}
        <tr>
            <td>{{ product.name }}</td>
            <td>{{ product.subcategory.category.name }}</td>
            <td>{{ product.subcategory.name }}</td>
            <td>{{ product.price }}</td>
            <td>{{ product.stock }}</td>
            <td>
                <a href="{% url 'products:product-edit' product.id %}" class="btn btn-sm btn-warning">Edit</a>
                <a href="{% url 'products:product-delete' product.id %}" class="btn btn-sm btn-danger">Delete</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">No products found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
